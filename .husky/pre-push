#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸš€ Running pre-push checks..."

# 1. Run all tests
echo "ğŸ§ª Running test suite..."
npm test || {
  echo "âŒ Tests failed. Fix failing tests before pushing."
  exit 1
}

# 2. Check test coverage
echo "ğŸ“Š Checking test coverage..."
npm run test:coverage || {
  echo "âš ï¸  Coverage check completed with warnings."
}

# 3. Run gas optimization check
echo "â›½ Checking gas usage..."
npm run test:gas || {
  echo "âš ï¸  Gas check completed."
}

# 4. Compile contracts
echo "ğŸ”¨ Compiling contracts..."
npm run compile || {
  echo "âŒ Contract compilation failed."
  exit 1
}

echo "âœ… All pre-push checks passed!"
